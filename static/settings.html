<!DOCTYPE html>
<html>
<head>
  <title>Settings</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container my-3">

  <h4 class="mb-3">Laundry Settings</h4>

  <!-- Laundry Name -->
  <div class="card p-3 mb-3">
    <h6>Laundry Name</h6>
    <input id="laundryName" class="form-control mb-2">
    <button class="btn btn-success" onclick="saveName()">Save</button>
  </div>

  <!-- Add Item -->
  <div class="card p-3 mb-3">
    <h6>Add Item</h6>
    <input id="itemName" class="form-control mb-2" placeholder="Item name">
    <input id="itemPrice" class="form-control mb-2" placeholder="Price">
    <button class="btn btn-success" onclick="addItem()">Add</button>
  </div>

  <!-- Items List -->
  <div class="card p-3">
    <h6>Items</h6>
    <ul id="items" class="list-group"></ul>
  </div>

</div>

<script>
function loadSettings(){
  fetch("/settings")
    .then(r => r.json())
    .then(d => {
      document.getElementById("laundryName").value = d.laundry_name;
      let html = "";
      d.items.forEach(i => {
        html += `
          <li class="list-group-item d-flex justify-content-between">
            ${i[1]} – ₹${i[2]}
            <button class="btn btn-sm btn-danger" onclick="removeItem(${i[0]})">Remove</button>
          </li>`;
      });
      document.getElementById("items").innerHTML = html;
    });
}

function saveName(){
  fetch("/settings/laundry_name", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({ laundry_name: laundryName.value })
  }).then(() => alert("Saved"));
}

function addItem(){
  fetch("/items/add", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({
      name: itemName.value,
      price: itemPrice.value
    })
  }).then(() => {
    itemName.value = "";
    itemPrice.value = "";
    loadSettings();
  });
}

function removeItem(id){
  fetch("/items/delete", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({ id })
  }).then(() => loadSettings());
}

loadSettings();
</script>

</body>
</html>
